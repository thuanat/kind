deploymentMode: SingleBinary

# Phần cấu hình cốt lõi của Mimir
mimir:
  structuredConfig:
    multitenancy_enabled: false
    common:
      storage:
        backend: filesystem
    blocks_storage:
      backend: filesystem
      filesystem:
        dir: /data/mimir/blocks
    alertmanager_storage:
      backend: filesystem
      filesystem:
        dir: /data/mimir/alerts
    ruler_storage:
      backend: filesystem
      filesystem:
        dir: /data/mimir/rules

# Ép Pod chạy Single và xử lý lỗi Read-only
singleBinary:
  replicas: 1
  persistence:
    enabled: false
  extraVolumes:
    - name: storage
      emptyDir: {}
  extraVolumeMounts:
    - name: storage
      mountPath: /data

# TẮT TOÀN BỘ CÁC THÀNH PHẦN DISTRIBUTED
# Đây là phần quan trọng để không còn thấy gateway hay kafka
ingester: { replicas: 0 }
querier: { replicas: 0 }
query_frontend: { replicas: 0 }
distributor: { replicas: 0 }
compactor: { replicas: 0 }
store_gateway: { replicas: 0 }
ruler: { replicas: 0 }
alertmanager: { replicas: 0 }
query_scheduler: { replicas: 0 }
overrides_exporter: { replicas: 0 }
gateway: { enabled: false }
nginx: { enabled: false }