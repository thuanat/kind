# =========================================================
# MIMIR SINGLE BINARY CONFIG FOR LAB (KIND/K8S)
# =========================================================

# 1. Ép chạy chế độ một Pod duy nhất
deploymentMode: SingleBinary

# 2. Cấu hình Mimir Core
mimir:
  structuredConfig:
    multitenancy_enabled: false
    
    # Cấu hình lưu trữ Filesystem thay vì S3/Minio
    common:
      storage:
        backend: filesystem
    blocks_storage:
      backend: filesystem
      filesystem:
        dir: /data/mimir/blocks
    alertmanager_storage:
      backend: filesystem
      filesystem:
        dir: /data/mimir/alerts
    ruler_storage:
      backend: filesystem
      filesystem:
        dir: /data/mimir/rules

# 3. Tắt tất cả các thành phần của bản Distributed
ingester:
  replicas: 0
querier:
  replicas: 0
query_frontend:
  replicas: 0
distributor:
  replicas: 0
compactor:
  replicas: 0
store_gateway:
  replicas: 0
ruler:
  replicas: 0
alertmanager:
  replicas: 0
query_scheduler:
  replicas: 0
overrides_exporter:
  replicas: 0

# 4. Tắt các phụ kiện tốn tài nguyên (Minio, Kafka)
minio:
  enabled: false
nginx:
  enabled: false # Tắt gateway rời để tránh lỗi 502 khi config sai

# 5. Cấu hình Service để Grafana dễ kết nối
# Service này sẽ gom vào Pod Single Binary
results_cache:
  enabled: false
chunks_cache:
  enabled: false